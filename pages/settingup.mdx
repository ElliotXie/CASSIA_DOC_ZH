# 设置与安装

## 安装所需的包

首先，确保您已安装 `reticulate` 包和 `devtools` 包。

```R
install.packages("reticulate")
install.packages("devtools")
```

接下来，您需要安装 CASSIA 包。您可以直接安装：

```R
# 安装 CASSIA 包
library(devtools)
devtools::install_github("ElliotXie/CASSIA/CASSIA_R")
```

## 设置 Python 环境

CASSIA 依赖 Python 进行部分后端处理。加载 CASSIA 包时，它会尝试自动设置所需的 Python 环境。但是，如果遇到问题，您可以使用 `setup_cassia_env()` 函数手动创建和配置必要的 Python 环境。

```R
library(CASSIA)

# 如果需要，手动设置 Python 环境
setup_cassia_env(conda_env = "cassia_env")
```

此函数将：

- 如果名为 `cassia_env` 的 Conda 环境不存在，则创建一个新的环境。
- 安装所需的 Python 包：`openai`、`pandas`、`numpy`、`scikit-learn`、`requests` 和 `anthropic`。

## 设置 API 密钥

要使用像 OpenAI 的 GPT-4、Anthropic 的 Claude 或通过 OpenRouter 的模型等 LLM，您需要使用 `setLLMApiKey()` 函数设置您的 API 密钥。

**注意：您必须至少设置一个 API 密钥才能使用 CASSIA。**

```R
# 对于 OpenAI
setLLMApiKey("your_openai_api_key", provider = "openai", persist = TRUE)

# 对于 Anthropic
setLLMApiKey("your_anthropic_api_key", provider = "anthropic", persist = TRUE)

# 对于 OpenRouter
setLLMApiKey("your_openrouter_api_key", provider = "openrouter", persist = TRUE)
```

- 将 `"your_api_key"` 替换为您的实际 API 密钥。
- 根据您的提供商，将 `provider` 设置为 `"openai"`、`"anthropic"` 或 `"openrouter"`。
- 设置 `persist = TRUE` 会将密钥保存在您的 `.Renviron` 文件中，以供将来会话使用。

## 如何选择模型和提供商

有三个提供商可供选择：`openai`、`anthropic` 和 `openrouter`。每个提供商都有自己的模型和定价。
请注意，模型名称必须完全按照下面所示进行设置，否则将找不到模型。

### OpenAI

OpenAI 有三个最推荐的模型可供选择：

- `gpt-4o`
- `gpt-4o-mini`
- `o1-mini`

`gpt-4o` 是最平衡且推荐的模型。`gpt-4o-mini` 是 `gpt-4o` 的更便宜、更快的版本。`o1-mini` 是功能更强大的版本，能够进行更复杂的推理，但成本更高，在默认设置下不推荐使用。

### Anthropic

Anthropic 有一个推荐模型：这是性能最佳的强大模型。

- `claude-3-5-sonnet-20241022`

### OpenRouter

OpenRouter 是一个平台，提供对主要提供商支持的几乎所有模型的访问。实际上建议使用 OpenRouter 访问 claude-3-5-sonnet，因为它具有最高的速率限制。我们也可以用它来访问一些开源模型，例如 llama-3.2 和 deepseek2。这些开源模型便宜得多，性能略有下降。

- `anthropic/claude-3.5-sonnet`
- `openai/gpt-4o-2024-11-20`
- `meta-llama/llama-3.2-90b-vision-instruct`
